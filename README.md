# Portmone
This is a little REST API interface example based on the [Node.js](https://nodejs.org/), [Express.js](https://expressjs.com/), and [Vue.js](https://vuejs.org/) that make replenishment of a [Kyivstar mobile account](https://pay.kyivstar.ua/) by credit card data.

This API example based on external services data exchanging between the [Portmone](https://www.portmone.com.ua/) and the [PrivatBank](https://privatbank.ua/), and it's written with the aim of immersion in the learning process of [Node.js](https://nodejs.org/) that I started to learn a year ago.

As soon as possible I represent here an API without any dependencies as Express.js and any middlewares that would work on both HTTP server and Sockets. Actually I already have the working code, but it still on testing.

## Init
If you have the `Docker`, you can run the `./dock` file to automatically builds and starts a container with `Node.js` inside

Type this in a command line
```bash
cd src && npm run serve
```
If the server starts normally, you'l see a text `Start API on 0.0.0.0:5000`

## Usage
You can use it by represented interface of the `Vue.js` by local address `http://0.0.0.0:5000/` or by API usage with a [Postman](https://www.postman.com/) software

#### API Usage

* **POST /v1/encode**

    *Encodes credit card data to an encrypted hash data with generated master key as a decrypt form factor.*
    *Once you encode it, and then just use it all the time without sending your secret data:*
    *`card_number`, `cvv2`, `MM`, `YY`*

    ```javascript
    // Request Data
    {
      // Month of a credit card
      "MM": "10",
      // Year of a credit card
      "YY": "18",
      // cvv2 code
      "cvv2": "123",
      // the 16th-length card number
      "card_number": "1234567890123456"
    }

    // Response Data
    {
      "success": true,
      "authKey": "J!oJu!Dqsj&(90Nh,m)&3jO*oK6@.xeh"
    }
    ```

* **POST /v1/decode**

    *Decodes a credit card data back by master key to a normal representation of `card_number`, `cvv2`, `MM`, `YY`*

    ```javascript
    // Request Data
    {
      "authKey": "J!oJu!Dqsj&(90Nh,m)&3jO*oK6@.xeh",
    }

    // Response Data
    {
      "MM": "10",
      "YY": "18",
      "cvv2": "123",
      "card_number": "1234567890123456"
    }
    ```

* **POST /v1/bill**

    *Starts a replenishment mechanism using both external Portmone and PrivatBank API interfaces.*
    *It's expecting the `authKey` or the credit card data `card_number`, `cvv2`, `MM`, `YY` as request data*

    ```javascript
    // Request Data
    {
      "amount": 1,
      "phone": "067XXXXXXX",
      "authKey": "J!oJu!Dqsj&(90Nh,m)&3jO*oK6@.xeh",
    }

    // Request Data
    {
      "amount": 1,
      "phone": "067XXXXXXX",
      "MM": "10",
      "YY": "18",
      "cvv2": "123",
      "card_number": "1234567890123456"
    }

    // Response Data
    {
      "location": {
         // The latitude point, where the replenishment was fired from
         "lat": "50.454692",
         // The longitude point, where the replenishment was fired from
         "lng": "30.529863",
         // The location name, where the replenishment was fired from
         "name": "Киев, Арка"
      },
      "success": true,
    }
    ```

* **POST /v1/pin**

    *Confirmation of the replenishment by 6-digits pin code generated by PrivatBank*

    ```javascript
    // Request Data
    {
      "pin": "986133",
    }

    // Response Data
    {
      "success": true,
    }
    ```
